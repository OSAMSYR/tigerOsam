#include <DHT11.h>
#include <SoftwareSerial.h>


int MOTION = 2;
int BUTTON = 5;
int cur = 0;
int buttonState = 0;
int SOUND = A0;
int throat = 120;
int temp = 0;
int LIGHT = A1;
int HUMMID = A2;
DHT11 dht11(HUMMID);
float temperature = 0 ;
float humidity = 0;
#define BT_RXD 7
#define BT_TXD 8
SoftwareSerial bluetooth(BT_RXD,BT_TXD); //블루투스의 Tx, Rx핀을 7번 8번핀으로 설정

void setup() {
  // 시리얼 통신의 속도를 9600으로 설정
  Serial.begin(9600);
  bluetooth.begin(9600);
  pinMode(BUTTON,INPUT);
  pinMode(SOUND,INPUT);
}

void loop() { //코드를 무한반복합니다.
  if (bluetooth.available()) {    // 블루투스
    Serial.write(bluetooth.read());
  }
  if (Serial.available()) {
    bluetooth.write(Serial.read());
  }
  buttonState = digitalRead(BUTTON); // 버튼 단발성, 바운스 해결
  if(buttonState!=cur){
   delay(100);
  }
  if(buttonState==LOW){
    Serial.println("push");
    while(1){
      if(buttonState!=digitalRead(BUTTON)){
        break;
      }
    }
  }
  else{
   
  }
  cur = buttonState;
  if(analogRead(SOUND)>=throat){// 사운드
    Serial.println("조용히");
  } 
  temp = analogRead(LIGHT);
  // 조도
  Serial.print("cds = ");
  Serial.println(temp);
  // 온습도
  
  dht11.read(humidity,temperature);
  Serial.print("Humidity = ");
  Serial.println(humidity);
  Serial.print("temperature = ");
  Serial.println(temperature);
  delay(1000);
}
